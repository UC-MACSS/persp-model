---
title: "Xu_Ningyin_PS5: Linear Regression"
author: "Ningyin Xu"
date: "2/8/2017"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
library(readr)
library(modelr)
library(broom)
set.seed(1234)
bidendata <- read_csv('data/biden.csv')
names(bidendata) <- stringr::str_to_lower(names(bidendata))
```

## Problem 1. Describe the data

```{r, include=TRUE}
ggplot(bidendata, mapping = aes(x = biden)) + 
   geom_histogram(binwidth = 1) +
   labs(title = "Distribution of Biden's feeling thermometer",
        x = "feeling thermometer",
        y = "Frequency count of individuals")
```

From the histogram shown above, one can tell most people have high scores (greater than 50) in feeling thermometer for Joe Biden, which means they like him. However, the highest frequency count among all the bins appears in the score of 50, saying the group of people who have indifferent attitude about him is the largest one.

## Problem 2. Simple linear regression

The summary of simple linear regression is shown as below.
```{r simple_lm1, echo = FALSE, include=TRUE}
sim_mod1 <- lm(biden ~ age, data = bidendata)
summary(sim_mod1)
```
To make it clearer, the estimates of parameters and their standard errors, R-squared, and adjusted R-squared are the following:
```{r simple_lm2, echo = FALSE, include=TRUE}
tidy(sim_mod1)
glance(sim_mod1)$r.squared
glance(sim_mod1)$adj.r.squared
```

1&2). One could say there is a relationship between the predictor and the response, since the p-value of age in the summary shows that there are more than 90% chance of rejecting the null hypothesis, but statistically speaking the relationship is not very strong/significant, which requires greater than 95%.

3). The positive sign of the estimate of age shows that it has a positive effect on the response. 

4). The R-squared is about 0.002018, and the adjusted R-squared is about 0.001465. This means only about 0.2% of variation is explained by age, implying that the model is not fitting the actual data well.

```{r simple_lm_pred, echo = FALSE, include=TRUE}
grid <- bidendata %>%
  data_grid(age)
grid <- grid %>%
  add_predictions(sim_mod1)
ggplot(bidendata, aes(age)) +
  geom_point(aes(y = biden)) +
  geom_line(aes(y=pred), data = grid,, color = 'red', size = 1)
```
